// debidata.asp
//
// Debi data
//


;;============================
;; These value are stack offsets used for temporary space during debi_generate_disassembly()
;;
_INS_DISPLAYED                = 4
_SHIFT_LEFT                   = 8
_SHIFT_RIGHT                  = 12
_INS_BYTES                    = 16
_TEMP_DATA                    = 20



;;============================
;; This variable is used
;;
debi_instruction_output     u8   60 dup(0)
debi_single_step            u8   0
debi_resume                 u8   0
debi_busy                   u8   0


;;============================
;; This is the screen that is the main Debi debugging screen
;;
//                                          1    1    2    2    3    3    4    4    5    5    6    6    7    7
//                                0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+
debi_debug_info_screen      u8   "פ|                                      ץ|פ F5:go  F8:step  F9:break  F10:over     ץ"   // 0
                            u8   "-Instruction stream-|תתתת:תתתתתתתת--------------------+-Instruction Pointer-----"   // 1
                            u8   "-0010 תת תת תת תת תת תת תת תת תת תת תת תת תת תת תת תת |cs:eip-תתתת  cr0-תתתתתתתת"   // 2
                            u8   "+0000 תת תת תת תת תת תת תת תת תת תת תת תת תת תת תת תת |   תתתתתתתת  cr4-תתתתתתתת"   // 3
                            u8   "+0010 תת תת תת תת תת תת תת תת תת תת תת תת תת תת תת תת |        vme ne ts de "   // 4
                            u8   255
                            u8   "-QueryBox----------+"   // 21
Infobox_text                u8   "-InfoBox----------------------------------------------------"   // (second half of 21)
                            u8   "                   |                                                            "   // 22
                            u8   "                   |               פ Low-Level Debi(tm) Debugger ץ                "   // 23
                            u8   "                   |               פ      by Beatleworks, Inc.   ץ                ",0 // 24

//                                          1    1    2    2    3    3
//                                0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+
debi_debug_gdt_idt          u8   "-¯GDT¯-|תתתתתתתת---------------¯D1¯-1ֲ-+",255
                            u8   "  60+ 56+  52+ 48+  44+ 40+  36+ 32+ ||",255
                            u8   " +ֲֲֲֲֲֵ| +ֲֲֲֲֲֵ| +ֲֲֲֲֲֵ| +ֲֲֲֲֲֵ| |°|",255
                            u8   " תתתתתתתת תתתתתתתת תתתתתתתת תתתתתתתת |°|",255
                            u8   " תתתתתתתת תתתתתתתת תתתתתתתת תתתתתתתת |°|",255
                            u8   " +ֱֱֱֱֱֵ| +ֱֱֱֱֱֵ| +ֱֱֱֱֱֵ| +ֱֱֱֱֱֵ| |°|",255
                            u8   "  28+ 24+  20+ 16+  12+  8+   4+  0+ ||",0

//                                          1    1    2    2    3    3
//                                0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+
debi_debug_fpu              u8   "-FPU-----------------------------¯D1¯-2+",255
                            u8   "st0 תתתתתתתתתתתתתתתתתתתת  cw תתתתתתתת  |",255
                            u8   "st1 תתתתתתתתתתתתתתתתתתתת  sw תתתתתתתת  |",255
                            u8   "st2 תתתתתתתתתתתתתתתתתתתת  tw תתתתתתתת  |",255
                            u8   "st3 תתתתתתתתתתתתתתתתתתתת               |",255
                            u8   "st4 תתתתתתתתתתתתתתתתתתתת  fcs:תתתתתתתת |",255
                            u8   "st5 תתתתתתתתתתתתתתתתתתתת feip:תתתתתתתת |",255
                            u8   "st6 תתתתתתתתתתתתתתתתתתתת  fds:תתתתתתתת |",255
                            u8   "st7 תתתתתתתתתתתתתתתתתתתת fesi:תתתתתתתת |",0

//                                          1    1    2    2    3    3
//                                0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+
debi_debug_disasm           u8   "-Disassembly-|תתתת:תתתתתתתת-----------3+",255
                            u8   "                                       |",255
                            u8   "                                       |",255
                            u8   "                                       |",255
                            u8   "                                       |",255
                            u8   "                                       |",255
                            u8   "                                       |",0

//                                          1    1    2    2    3    3
//                                0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+
debi_debug_stack            u8   "-Stack-|תתתת:תתתתתתתת----------¯D1¯-4ֲ-+",255
                            u8   " תת תת תת תת +0044  תת תת תת תת +001c||",255
                            u8   " תת תת תת תת +0040  תת תת תת תת +0018|°|",255
                            u8   " תת תת תת תת +003c  תת תת תת תת +0014|°|",255
                            u8   " תת תת תת תת +0038  תת תת תת תת +0010|°|",255
                            u8   " תת תת תת תת +0034  תת תת תת תת +000c|°|",255
                            u8   " תת תת תת תת +0030  תת תת תת תת +0008|°|",255
                            u8   " תת תת תת תת +002c  תת תת תת תת +0004|°|",255
                            u8   " תת תת תת תת +0028  תת תת תת תת +0000||",0

//                                          1    1    2    2    3    3
//                                0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+
debi_debug_registers        u8   "-Registers----------------------------5+",255
                            u8   " eax תתתתתתתת  ds תתתת  eflags תתתתתתתת|",255
                            u8   " ebx תתתתתתתת  es תתתת  - nt  of acf|",255
                            u8   " ecx תתתתתתתת  fs תתתת  - pf  sf  if|",255
                            u8   " edx תתתתתתתת  gs תתתת  + df  zf  cf|",255
                            u8   " esi תתתתתתתת          + ebp תתתתתתתת  |",255
                            u8   " edi תתתתתתתת  ss תתתת-ֱ esp תתתתתתתת  |",0

//                                          1    1    2    2    3    3
//                                0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+0+ֱֱ+5+ֱֱ+
debi_debug_stack_mem        u8   "-Stack------¯D1¯--+Mem|תתתתתתתת--¯D1¯ֲ6+",255
                            u8   " תת תת תת תת +001c| תת תת תת תת +001c||",255
                            u8   " תת תת תת תת +0018| תת תת תת תת +0018|°|",255
                            u8   " תת תת תת תת +0014| תת תת תת תת +0014|°|",255
                            u8   " תת תת תת תת +0010| תת תת תת תת +0010|°|",255
                            u8   " תת תת תת תת +000c| תת תת תת תת +000c|°|",255
                            u8   " תת תת תת תת +0008| תת תת תת תת +0008|°|",255
                            u8   " תת תת תת תת +0004| תת תת תת תת +0004|°|",255
                            u8   " תת תת תת תת +0000| תת תת תת תת +0000||",0

debi_screen_format          u8   2                                       // FPU
                            u8   3                                       // Disassembly
                            u8   5                                       // Registers
                            u8   6                                       // Stack & Mem


;;============================
;; These are the different types of InfoBox's that get drawn depending on what item the mouse is currently over
;; * Note:  These use encoding, the numbers below represent the "insert_text_*" variables.  This was added to save storage
;;          space for frequently repeated text items.  A code of 255 fills the rest of the line with spaces, 1 uses ASCII-196's
;;          and a 0 is used to terminate the InfoBox.  Special character are also recognized, פ for reverse-video-start and
;;          ץ for reverse-video-stop.  * Refer to the debi_clear_info_box() routine for more information.
;;
infobox_clear               u8   "-InfoBox",1
                            u8   255
                            u8   255
                            u8   255,0

insert_text_2               u8   "   ת ",0
insert_text_3               u8   "תתתת ",0
insert_text_4               u8   "Hex: ",0
insert_text_5               u8   "Bin: ",0
insert_text_6               u8   "Dec: ",0
insert_text_7               u8   "Signed: ",0
insert_text_8               u8   "-InfoBox-",0
insert_text_9               u8   "®STD¯",0
insert_text_10              u8   "®ALT¯",0
insert_text_11              u8   "®CTRL¯",0
insert_text_12              u8   "Exponent:",0
insert_text_13              u8   "Mantissa:",0
insert_text_14              u8   "Float",0
insert_text_15              u8   "float",0
insert_text_16              u8   "Normal",0
insert_text_17              u8   "ized:",0
insert_text_18              u8   "Status: ",0

infobox_byte                u8   8,"(byte)",1
                            u8   4,2,2,255
                            u8   5,3,3,255
                            u8   6,"‏תתת  ",7,"‏תתת",255,0

infobox_word                u8   8,"(word)",1
                            u8   4,2,2,2,2,255
                            u8   5,3,3,3,3,255
                            u8   6,"‏תתתתת  ",7,"‏תתתתת",255,0

infobox_dword               u8   8,"(dword)-",9,1
                            u8   4,2,2,2,2,2,2,2,2,255
                            u8   5,3,3,3,3,3,3,3,3,255
                            u8   6,"‏תתתתתתתתתת  ",7,"‏תתתתתתתתתת",255,0

infobox_dworda              u8   8,"(dword/",15,"32)-",10,1
                            u8   12,255
                            u8   13,255
                            u8   " ",14,"32:",255,0

infobox_dwordc              u8   8,"(dword/",15,"32)-",11,1
                            u8   255
                            u8   "   ",14,"32:",255
                            u8   16,17,255,0

infobox_reg32               u8   8,"(32-bit)-",9,1
                            u8   4,2,2,2,2,2,2,2,2,255
                            u8   5,3,3,3,3,3,3,3,3,255
                            u8   6,"‏תתתתתתתתתת  ",7,"‏תתתתתתתתתת",255,0

infobox_reg32a              u8   8,"(32-bit/",15,"32)-",10,1
                            u8   12,255
                            u8   13,255
                            u8   " ",14,"32:",255,0

infobox_reg32c              u8   8,"(32-bit/",15,"32)-",11,1
                            u8   255
                            u8   "   ",14,"32:",255
                            u8   16,17,255,0

infobox_flag                u8   8,"(flag)-",9,1
                            u8   18,"תתת",255
                            u8   255
                            u8   255,0

infobox_bin32               u8   8,"(bin32)-",9,1
                            u8   4,2,2,2,2,2,2,2,2,255
                            u8   5,3,3,3,3,3,3,3,3,255
                            u8   6,"‏תתתתתתתתתת  ",7,"‏תתתתתתתתתת",255,0

infobox_f32                 u8   8,"(",15,"32)-",9,1
                            u8   12,255
                            u8   13,255
                            u8   " ",14,"32:",255,0

infobox_f32a                u8   8,"(",15,"32)-",10,1
                            u8   255
                            u8   "   ",14,"32:",255
                            u8   16,17,255,0

infobox_f64                 u8   8,"(",15,"64)-",9,1
                            u8   12,255
                            u8   13,255
                            u8   " ",14,"32:",255,0

infobox_f64a                u8   8,"(",15,"64)-",10,1
                            u8   255
                            u8   14,"64:",255
                            u8   " ",16,":",255,0

infobox_f80                 u8   8,"(",15,"80)-",9,1
                            u8   12,255
                            u8   13,255
                            u8   " ",14,"80:",255,0

infobox_f80a                u8   8,"(",15,"80)-",10,1
                            u8   255
                            u8   14,"80:",255
                            u8   " ",16,":",255,0



;;============================
;; This system allows approximately 2800 items to be referenced on the screen at any one time
;; The memory used for this is stored off the MONO screen in MONO video memory (b0fa0-b7fffh)
;; * Note, for more information see INF\FAULT.INF
debi_udf_window_areas       u32  0
debi_text_1                 u8   "Trap/error/exception | #num - Description"


debi_count                  u8   0
debi_mouse_pointer_update   u8   0
debi_mouse_y                u8   12
debi_mouse_y_last           u8   25                                  // Just off the screen
debi_mouse_y_counter        u32  0
debi_mouse_x                u8   40
debi_mouse_x_last           u8   0
debi_color_last             u8   0
debi_mouse_x_counter        u32  0
highlight_last_point1       u16  0
highlight_last_point2       u16  0
last_object_segment         u16  0                                   //
last_object_offset          u32  0
// * Note:  mouse_redirect is in SOURCE\MOUSE.ASP
// * Note:  keyboard_redirect is in SOURCE\KEYBOARD.ASP



;;============================
;; This portion of the data is used to identify what has changed from the previous use of the debi_debug() algorithms
already_here                u8   0
                                                                    // Identified internally as:
last_eax                    u32  0ffffffffh                          // eax=1, ax=20, ah=30, al=35
last_ebx                    u32  0ffffffffh                          // ebx=2, bx=21, bh=31, bl=36
last_ecx                    u32  0ffffffffh                          // ecx=3, cx=22, ch=32, cl=37
last_edx                    u32  0ffffffffh                          // edx=4, dx=23, dh=33, dl=38
last_esi                    u32  0ffffffffh                          // esi=5, si=24
last_edi                    u32  0ffffffffh                          // edi=6, di=25
last_esp                    u32  0ffffffffh                          // esp=7, sp=26
last_ip                     u32  0ffffffffh                          // eip=8, ip=28
last_bp                     u32  0ffffffffh                          // ebp=9, bp=27
current_esp                 u32  0
current_ebp                 u32  0
last_cs                     u16  0ffffh                              // cs=10
last_ds                     u16  0ffffh                              // ds=11
last_es                     u16  0ffffh                              // es=12
last_fs                     u16  0ffffh                              // fs=13
last_gs                     u16  0ffffh                              // gs=14
last_ss                     u16  0ffffh                              // ss=15
last_eflags                 u32  0ffffffffh                          // flags=16
last_fpu_state              u8   108 dup(0)
current_fpu_state           u8   108 dup(0)



//=============================
;; Data used in the debi_generate_disassembly() procedure
    sreg_override           u8   0
    sign_extend             u8   0
    movxx                   u8   0
    reverse_regs            u8   0
    special_reg             u8   0
    mod_reg_rm_byte         u8   0
    sib_byte                u8   0
    byte_word_size          u8   0
    seg_override            u8   0
    op_size_override        u16  0
    adr_size_override       u16  0

    int3_text               u8   "int3"
    aaa_text                u8   "aaa"
    xadd_text               u8   "x"
    add_text                u8   "add"
    aas_text                u8   "aas"
    cbw_text                u8   "cbw"
  cwde_text:
    cwd_text                u8   "cwd"
                            u8   "e"
    cdq_text                u8   "cdq"
    clc_text                u8   "clc"
    cld_text                u8   "cld"
    cli_text                u8   "cli"
    cmc_text                u8   "cmc"
    daa_text                u8   "daa"
    das_text                u8   "das"
    hlt_text                u8   "hlt"
    into_text               u8   "into"
  iretd_text:
    iret_text               u8   "iret"
                            u8   "d"
    lahf_text               u8   "lahf"
    leave_text              u8   "leave"
    lock_text               u8   "lock"
    nop_text                u8   "nop"
  popad_text:
    popa_text               u8   "popa"
                            u8   "d"
  popfd_text:
    popf_text               u8   "popf"
                            u8   "d"
  pushad_text:
    pusha_text              u8   "pusha"
                            u8   "d"
  pushfd_text:
    pushf_text              u8   "pushf"
                            u8   "d"
    ret_text                u8   "ret"
    retf_text               u8   "retf"
    sahf_text               u8   "sahf"
    stc_text                u8   "stc"
    std_text                u8   "std"
    sti_text                u8   "sti"
    wait_text               u8   "wait"
    xlat_text               u8   "xlat"
    aad_text                u8   "aad"
    aam_text                u8   "aam"
    clts_text               u8   "clts"
    wbinvd_text             u8   "wb"
    invd_text               u8   "invd"
    arpl_text               u8   "arpl"
    bound_text              u8   "bound"
    bswap_text              u8   "bswap"
  ()
    db()  "call"
                            u8   "f"
    cmpxchg_text            u8   "cmpxchg"
    enter_text              u8   "enter"
    int_text                u8   "int"
    ja_text                 u8   "ja.u"
    jc_text                 u8   "jc"
    jnc_text                u8   "jnc"
    jbe_text                u8   "jbe.u"
    jz_text                 u8   "jz"
    jnz_text                u8   "jnz"
    jl_text                 u8   "jl.s"
    jg_text                 u8   "jg.s"
    jle_text                u8   "jle.s"
    jge_text                u8   "jge.s"
    js_text                 u8   "js"
    jns_text                u8   "jns"
    jp_text                 u8   "jp"
    jnp_text                u8   "jnp"
    jo_text                 u8   "jo"
    jno_text                u8   "jno"
    seta_text               u8   "seta.u"
    setc_text               u8   "setc"
    setnc_text              u8   "setnc"
    setbe_text              u8   "setbe.u"
    setz_text               u8   "setz"
    setnz_text              u8   "setnz"
    setl_text               u8   "setl.s"
    setg_text               u8   "setg.s"
    setle_text              u8   "setle.s"
    setge_text              u8   "setge.s"
    sets_text               u8   "sets"
    setns_text              u8   "setns"
    setp_text               u8   "setp"
    setnp_text              u8   "setnp"
    seto_text               u8   "seto"
    setno_text              u8   "setno"
    jcxz_text               u8   "jcxz"
    jecxz_text              u8   "jecxz"
  jmp_far_text:
    jmp_text                u8   "jmp"
                            u8   "f"
  movsx_text:
    mov_text                u8   "mov"
                            u8   "sx"
    movzx_text              u8   "movzx"
    lds_text                u8   "lds"
    les_text                u8   "les"
    lea_text                u8   "lea"
  loopne_text:
    loop_text               u8   "loop"
                            u8   "ne"
  looped_text:
    loope_text              u8   "loope"
    pop_text                u8   "pop"
  pushd_text:
    push_text               u8   "push"
                            u8   "d"
  repne_text:
    rep_text                u8   "rep"
                            u8   "ne"
    repe_text               u8   "repe"
    movsb_text              u8   "movsb"
    movsw_text              u8   "movsw"
    movsd_text              u8   "movsd"
    stosb_text              u8   "stosb"
    stosw_text              u8   "stosw"
    stosd_text              u8   "stosd"
    lodsb_text              u8   "lodsb"
    lodsw_text              u8   "lodsw"
    lodsd_text              u8   "lodsw"
    insb_text               u8   "insb"
    insw_text               u8   "insw"
    insd_text               u8   "insd"
    outsb_text              u8   "outs"
    outsw_text              u8   "outsw"
    outsd_text              u8   "outsd"
    cmpsb_text              u8   "cmpsb"
    cmpsw_text              u8   "cmpsw"
    cmpsd_text              u8   "cmpsd"
    scasb_text              u8   "scasb"
    scasw_text              u8   "scasw"
    scasd_text              u8   "scasd"
    setccc_text             u8   "setccc"
    bsf_text                u8   "bsf"
    bsr_text                u8   "bsr"
  btc_text:
    bt_text                 u8   "bt"
                            u8   "c"
    bts_text                u8   "bts"
    btr_text                u8   "btr"
    invlpg_text             u8   "invlpg"
    lar_text                u8   "lar"
    lfs_text                u8   "lfs"
    lgs_text                u8   "lgs"
    lss_text                u8   "lss"
    lgdt_text               u8   "lgdt"
    lidt_text               u8   "lidt"
    lldt_text               u8   "lldt"
    lmsw_text               u8   "lmsw"
    lsl_text                u8   "lsl"
    ltr_text                u8   "ltr"
    sldt_text               u8   "sldt"
    str_text                u8   "str"
    verr_text               u8   "verr"
    verw_text               u8   "verw"
    sgdt_text               u8   "sgdt"
    sidt_text               u8   "sidt"
    smsw_text               u8   "smsw"
  shld_text:
    shl_text                u8   "shl"
                            u8   "d"
    sal_text                u8   "sal"
  shrd_text:
    shr_text                u8   "shr"
                            u8   "d"
    sar_text                u8   "sar"
    imul_text               u8   "i"
    mul_text                u8   "mul"
    test_text               u8   "test"
    not_text                u8   "not"
    neg_text                u8   "neg"
    idiv_text               u8   "i"
    div_text                u8   "div"
  inc_text:
    in_text                 u8   "in"
                            u8   "c"
    dec_text                u8   "dec"
    rol_text                u8   "rol"
    rcl_text                u8   "rcl"
    ror_text                u8   "ror"
    rcr_text                u8   "rcr"
    xchg_text               u8   "xchg"
    or_text                 u8   "or"
    adc_text                u8   "adc"
    sbb_text                u8   "sbb"
    and_text                u8   "and"
    sub_text                u8   "sub"
    xor_text                u8   "xor"
    cmp_text                u8   "cmp"

    fadd_text               u8   "fadd"
  fmulp_text:
    fmul_text               u8   "fmul"
                            u8   "p"
  fcompp_text:
  fcomp_text:
    fcom_text               u8   "fcom"
                            u8   "p"
                            u8   "p"
  fsubrp_text:
  fsubr_text:
    fsub_text               u8   "fsub"
                            u8   "r"
                            u8   "p"
  fdivr_text:
    fdiv_text               u8   "fdiv"
                            u8   "r"
    fdivp_text              u8   "fdivp"
  fldcw_text:
    fld_text                u8   "fld"
                            u8   "cw"
  fstp_text:
    fst_text                u8   "fst"
                            u8   "p"
    fxch_text               u8   "fxch"
    fnop_text               u8   "fnop"
    fchs_text               u8   "fchs"
    fabs_text               u8   "fabs"
    ftst_text               u8   "ftst"
    fxam_text               u8   "fxam"
    fld1_text               u8   "fld1"
    fldl2t_text             u8   "fldl2t"
    fldl2e_text             u8   "fldl2e"
    fldpi_text              u8   "fldpi"
    fldg2_text              u8   "fldg2"
    fldn2_text              u8   "fldn2"
    fldz_text               u8   "fldz"
    f2xm1_text              u8   "f2xm1"
    fyl2x_text              u8   "fyl2x"
    fptan_text              u8   "fptan"
    fpatan_text             u8   "fpatan"
    fxtract_text            u8   "fxtract"
  fprem_text:
    fprem1_text             u8   "fprem1"
    fdecstp_text            u8   "fdecstp"
    fincstp_text            u8   "fincstp"
    fyl2xp1_text            u8   "fyl2xp1"
    fsqrt_text              u8   "fsqrt"
    fsincos_text            u8   "fsincos"
    frndint_text            u8   "frndint"
    fscale_text             u8   "fscale"
    fsin_text               u8   "fsin"
    fcos_text               u8   "fcos"
    fldenv_text             u8   "fldenv"
    fstenv_text             u8   "fstenv"
    fstcw_text              u8   "fstcw"
    fucompp_text            u8   "fucompp"
    fiadd_text              u8   "fiadd"
    fimul_text              u8   "fimul"
  ficomp_text:
    ficom_text              u8   "ficom"
                            u8   "p"
  fisubr_text:
    fisub_text              u8   "fisub"
                            u8   "r"
  fidivr_text:
    fidiv_text              u8   "fidiv"
                            u8   "r"
    fclex_text              u8   "fclex"
    finit_text              u8   "finit"
    fild_text               u8   "fild"
  fistp_text:
    fist_text               u8   "fist"
                            u8   "p"
    ffree_text              u8   "ffree"
  fucomp_text:
    fucom_text              u8   "fucom"
                            u8   "p"
    frstor_text             u8   "frstor"
    fstsw_text              u8   "fstsw"
    fbld_text               u8   "fbld"
    fbstp_text              u8   "fbstp"
    fsave_text              u8   "fsave"


  illegal_register:
    unknown_text            u8   "???"

    CONST_AL                  = 000b
    CONST_AX                  = 000b
    CONST_EAX                 = 000b
    CONST_ES                  = 000b

    CONST_CL                  = 001b
    CONST_CX                  = 001b
    CONST_ECX                 = 001b
    CONST_CS                  = 001b

    CONST_DL                  = 010b
    CONST_DX                  = 010b
    CONST_EDX                 = 010b
    CONST_SS                  = 010b

    CONST_BL                  = 011b
    CONST_BX                  = 011b
    CONST_EBX                 = 011b
    CONST_DS                  = 011b

    CONST_AH                  = 100b
    CONST_SP                  = 100b
    CONST_ESP                 = 100b
    CONST_FS                  = 100b

    CONST_CH                  = 101b
    CONST_BP                  = 101b
    CONST_EBP                 = 101b
    CONST_GS                  = 101b

    CONST_DH                  = 110b
    CONST_SI                  = 110b
    CONST_ESI                 = 110b

    CONST_BH                  = 111b
    CONST_DI                  = 111b
    CONST_EDI                 = 111b

    ebx_esi_register        u8   "ebx+esi"
    ebx_edi_register        u8   "ebx+edi"
    ebp_esi_register        u8   "ebp+esi"
    ebp_edi_register        u8   "ebp+edi"
    bx_si_register          u8   "bx+si"
    bx_di_register          u8   "bx+di"
    bp_si_register          u8   "bp+si"
    bp_di_register          u8   "bp+di"
    cs_register             u8   "cs"
    ds_register             u8   "ds"
    es_register             u8   "es"
    fs_register             u8   "fs"
    gs_register             u8   "gs"
    ss_register             u8   "ss"
    eax_register            u8   "e"
    ax_register             u8   "ax"
    ebx_register            u8   "e"
    bx_register             u8   "bx"
    ecx_register            u8   "e"
    cx_register             u8   "cx"
    edx_register            u8   "e"
    dx_register             u8   "dx"
    esi_register            u8   "e"
    si_register             u8   "si"
    edi_register            u8   "e"
    di_register             u8   "di"
    ebp_register            u8   "e"
    bp_register             u8   "bp"
    ah_register             u8   "ah"
    al_register             u8   "al"
    bh_register             u8   "bh"
    bl_register             u8   "bl"
    ch_register             u8   "ch"
    cl_register             u8   "cl"
    dh_register             u8   "dh"
    dl_register             u8   "dl"
    ip_register             u8   "ip"
    esp_register            u8   "e"
    sp_register             u8   "sp"
    st0_register            u8   "st0"
    st1_register            u8   "st1"
    st2_register            u8   "st2"
    st3_register            u8   "st3"
    st4_register            u8   "st4"
    st5_register            u8   "st5"
    st6_register            u8   "st6"
    st7_register            u8   "st7"
    cr0_register            u8   "cr0"
    cr1_register            u8   "cr1"
    cr2_register            u8   "cr2"
    cr3_register            u8   "cr3"
    cr4_register            u8   "cr4"
    cr5_register            u8   "cr5"
    cr6_register            u8   "cr6"
    cr7_register            u8   "cr7"
    dr0_register            u8   "dr0"
    dr1_register            u8   "dr1"
    dr2_register            u8   "dr2"
    dr3_register            u8   "dr3"
    dr4_register            u8   "dr4"
    dr5_register            u8   "dr5"
    dr6_register            u8   "dr6"
    dr7_register            u8   "dr7"
    tr0_register            u8   "tr0"
    tr1_register            u8   "tr1"
    tr2_register            u8   "tr2"
    tr3_register            u8   "tr3"
    tr4_register            u8   "tr4"
    tr5_register            u8   "tr5"
    tr6_register            u8   "tr6"
    tr7_register            u8   "tr7"
    flags_register          u8   "flags"
    zero_ffff               u8   "0ffffh"


    badnumber0              u8   " +Unsupported               ",0
    badnumber1              u8   " +NaN                       ",0
    badnumber2              u8   " -Unsupported               ",0
    badnumber3              u8   " -NaN                       ",0
    badnumber4              u8   " +Normal                    ",0
    badnumber5              u8   " +Infinity                  ",0
    badnumber6              u8   " -Normal                    ",0
    badnumber7              u8   " -Infinity                  ",0
    badnumber8              u8   " 0.0000000000000000000+00000",0
    badnumber9              u8   " +Empty                     ",0
    badnumber10             u8   "-0.0000000000000000000+00000",0
    badnumber11             u8   " -Empty                     ",0
    badnumber12             u8   " +Denormals                 ",0
    badnumber13             u8   " ?Unknown?                  ",0
    badnumber14             u8   " -Denormals                 ",0

    fpu_stat                u16  ?
    exponent                sword   0
    number10                f32   10.0
    point5                  f32    0.5
    digit                   u16  ?
    controlword             u16  ?

    temp_buffer             u8   40 dup(0)
